!function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=c[g]={exports:{}};b[g][0].call(k.exports,function(a){var c=b[g][1][a];return e(c?c:a)},k,k.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b){var c,d,e,f,g;g=4,f=10,c=50,d=a("./brick.coffee"),e=function(){function a(a){this.game=a,this.bc=this._initBrickCollection(),this.$wrapper=$("div#wrapper")}return a.prototype.addNewRow=function(){var a,b,c,e;for(b=this._getNewRandomBrickNums(),e=[],a=c=0;3>=c;a=++c)e.push(this.bc[a][-1]=new d(b[a],{x:a,y:-1},this.$wrapper));return e},a.prototype.rowsUp=function(){var a,b,c,d,e;for(e=[],a=c=d=g-1;0>=d?0>=c:c>=0;a=0>=d?++c:--c)e.push(function(){var c,d,e;for(e=[],b=c=d=f-1;-1>=d?-1>=c:c>=-1;b=-1>=d?++c:--c)this.bc[a][b]?(this.bc[a][b].up(),this.bc[a][b+1]=this.bc[a][b],e.push(this.bc[a][b]=null)):e.push(void 0);return e}.call(this));return e},a.prototype.onTap=function(){var a,b;return b=this,this.$wrapper.on("click","div.brick",a=function(){var a,c;return a=b._getPositionByDom(this),c=[],b._findAndReomveSameColorBricks(a,c),b._calculateFallDown(),setTimeout(function(){return b._findAndReomveMoreThanThreeNearByBricks(b.game.next)},300)})},a.prototype.checkThreeNear=function(){return this._findAndReomveMoreThanThreeNearByBricks()},a.prototype._calculateFallDown=function(){var a,b,c,d,e,h,i;for(i=[],c=e=0,h=g-1;h>=0?h>=e:e>=h;c=h>=0?++e:--e)i.push(function(){var e,g,h;for(h=[],d=e=0,g=f-1;g>=0?g>=e:e>=g;d=g>=0?++e:--e)this.bc[c][d]?h.push(void 0):(a=this._hasUpperBrick(c,d))?(b=a.position.y,this.bc[c][d]=a,this.bc[c][b]=null,h.push(a.down(a.position.y-d))):h.push(void 0);return h}.call(this));return i},a.prototype._hasUpperBrick=function(a,b){var c,d,e,g;for(c=d=e=b+1,g=f-1;g>=e?g>=d:d>=g;c=g>=e?++d:--d)if(this.bc[a][c])return this.bc[a][c];return null},a.prototype._removeBricks=function(a){var b,c,d,e;for(e=[],c=0,d=a.length;d>c;c++)b=a[c],this.bc[b.x][b.y].remove(),e.push(this.bc[b.x][b.y]=null);return e},a.prototype._findAndReomveMoreThanThreeNearByBricks=function(a){var b,c,d,e,h,i,j,k,l,m;for(e=[],h=j=0,l=g-1;l>=0?l>=j:j>=l;h=l>=0?++j:--j)for(i=k=0,m=f-1;m>=0?m>=k:k>=m;i=m>=0?++k:--k)c={x:h,y:i},(b=this.bc[h][i]&&!this._isPosInCollection(e,c))&&this._hasThreeSameColorBricks(c)&&(e.push(c),this._findNearBySameColorBricks(c,e));return e.length>0?(this._removeBricks(e),this._calculateFallDown(),d=this,setTimeout(function(){return d._findAndReomveMoreThanThreeNearByBricks(a)},300)):"function"==typeof a?a():void 0},a.prototype._hasThreeSameColorBricks=function(a){var b,c;return b=a.x,c=a.y,this._isVaildPosition({x:b,y:c+1})&&this._isVaildPosition({x:b,y:c+2})&&this._isTheSameColor(this.bc[b][c],this.bc[b][c+1])&&this._isTheSameColor(this.bc[b][c],this.bc[b][c+2])?!0:this._isVaildPosition({x:b+1,y:c})&&this._isVaildPosition({x:b+2,y:c})&&this._isTheSameColor(this.bc[b][c],this.bc[b+1][c])&&this._isTheSameColor(this.bc[b][c],this.bc[b+2][c])?!0:!1},a.prototype._findAndReomveSameColorBricks=function(a,b){return b.push(a),this._findNearBySameColorBricks(a,b),this._removeBricks(b)},a.prototype._findNearBySameColorBricks=function(a,b){return this._checkIsSameColorAndAdd(a,{x:a.x-1,y:a.y},b),this._checkIsSameColorAndAdd(a,{x:a.x+1,y:a.y},b),this._checkIsSameColorAndAdd(a,{x:a.x,y:a.y-1},b),this._checkIsSameColorAndAdd(a,{x:a.x,y:a.y+1},b)},a.prototype._checkIsSameColorAndAdd=function(a,b,c){var d,e;return this._isVaildPosition(b)&&(e=this.bc[b.x][b.y])&&!this._isPosInCollection(c,b)&&(d=this.bc[a.x][a.y],d.color===e.color)?(c.push(e.position),this._findNearBySameColorBricks(e.position,c)):void 0},a.prototype._isVaildPosition=function(a){return 0<=a.x&&a.x<=g-1&&0<=a.y&&a.y<=f-1},a.prototype._isTheSameColor=function(a,b){return a&&b?a.color===b.color:!1},a.prototype._getPositionByDom=function(a){var b,c;return b=parseInt($(a).attr("data-x")),c=parseInt($(a).attr("data-y")),{x:b,y:c}},a.prototype._isPosInCollection=function(a,b){var c,d,e;for(d=0,e=a.length;e>d;d++)if(c=a[d],c.x===b.x&&c.y===b.y)return!0;return!1},a.prototype._getNewRandomBrickNums=function(){var a,b,c;for(a=[],b=c=0;3>=c;b=++c)a.push(this._getRandomNum());return a},a.prototype._getRandomNum=function(){return parseInt(10*Math.random()/3)},a.prototype._initBrickCollection=function(){var a;return a=[],a[0]=[],a[1]=[],a[2]=[],a[3]=[],a},a}(),b.exports=e},{"./brick.coffee":2}],2:[function(a,b){var c,d,e;c=50,e=["rgb(105, 219, 21)","rgb(243, 35, 192)","rgb(0, 174, 255)","rgb(255, 150, 1)"],d=function(){function a(a,b,c){this.$wrapper=c,this.color=a,this.position=b,this.$dom=this._createDom(),this._appendToParent()}return a.prototype.up=function(a){var b;return null==a&&(a=1),b=this.position.y,b+=a,this.move(b)},a.prototype.down=function(a){var b;return null==a&&(a=1),b=this.position.y,b-=a,this.move(b)},a.prototype.move=function(a){var b,d;return this.position.y=a,b=this.position.x*c,d=-this.position.y*c,this.$dom.attr("data-y",a),this.$dom.css("-webkit-transform","translate3d("+b+"px, "+d+"px, 0)")},a.prototype.remove=function(){return this.$dom.remove()},a.prototype._createDom=function(){var a,b,d;return a=$("<div class='brick'></div>"),a.css({backgroundColor:e[this.color]}),b=this.position.x*c,d=-this.position.y*c,a.css("-webkit-transform","translate3d("+b+"px, "+d+"px, 0)"),a.attr("data-x",this.position.x),a.attr("data-y",this.position.y),a},a.prototype._appendToParent=function(){return this.$wrapper.append(this.$dom)},a}(),b.exports=d},{}],3:[function(a,b){var c,d,e=function(a,b){return function(){return a.apply(b,arguments)}};c=a("./brick-controller.coffee"),d=function(){function a(){this.next=e(this.next,this)}return a.prototype.start=function(){return this._initController(),this._initBricks(),this._onUserTap()},a.prototype.next=function(){var a;return this.brickController.addNewRow(),a=this,setTimeout(function(){return a.brickController.rowsUp()},10),setTimeout(function(){return a.brickController.checkThreeNear()},300)},a.prototype._initController=function(){return this.brickController=new c(this)},a.prototype._initBricks=function(){return this.addNew(),this.addNew(),this.addNew(),this.addNew(),this.addNew()},a.prototype._onUserTap=function(){return this.brickController.onTap()},a.prototype.addNew=function(){return this.brickController.addNewRow(),this.brickController.rowsUp()},a}(),b.exports=d},{"./brick-controller.coffee":1}],4:[function(a){var b,c;b=a("./game.coffee"),c=new b,c.start()},{"./game.coffee":3}]},{},[4]);